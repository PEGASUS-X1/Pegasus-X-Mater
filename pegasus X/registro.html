<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro</title>
    <link rel="stylesheet" href="./est.css">
    <script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-storage.js"></script>
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

<script>
    // sustituye aquí tus credenciales
    var firebaseConfig = {
        apiKey: "AIzaSyCowkKlW7BEgdp_8GeRfQgg42OkSOrGzm8",
  authDomain: "fotos-b8a54.firebaseapp.com",
  projectId: "fotos-b8a54",
  storageBucket: "fotos-b8a54.appspot.com",
  messagingSenderId: "1037713159028",
  appId: "1:1037713159028:web:7386b0783a47e73f8b7221",
  measurementId: "G-909LJ5JLLG"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    
</script>
</head>
<body>
    <style>

      .chet{
        display: none;
        color: #5eff00;
        text-align: center;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 30px;
      }

    </style>

  <audio id="miMusica" >
    <source src="https://github.com/1RubiUwU1/pegasus.tk/raw/main/Adm%C3%ADtelo%2C%20tienes%20a%20quien%20dedicarle%20este%20MASHUP%20%F0%9F%8E%B5.mp3" type="audio/mpeg">
</audio>


  <div class="container" id="elementoParaOcultar">
    <div class="btn-canbio">
        <span class="tab-button active" onclick="openTab('tab1')">Resgistro</span>
        <span class="tab-button" onclick="openTab('tab2')">Url</span>
    </div>
    <br>
    <br>
    <div id="tab1" class="tab" style="display: block;">
    <form id="data-form">
        <i class="fas fa-user"></i>
        <h1 class="titulo">Registro</h1>
      <label for="nombre">Nombre:</label>
      <input type="text" id="nombre" name="nombre" required>
      <br>
      <label for="password">Password:</label>
      <input type="password" id="codigo" name="codigo" required>
      <br>
      <label for="modelo">Modelo:</label>
      <input type="text" id="modelo" name="modelo" value="basico" disabled>
      <br>
      <label for="url">Url Del perfil:</label>
      <input type="url" id="url" name="url" required>
      <br>
      <img class="previsualizacion" id="preview-image" src="" alt="">
      <a id="preview"  onclick="mostrarVistaPrevia()">Ver Perfil</a>
      <a id="preview-no" style="display: none;" onclick="NomostrarVistaPrevia()">No Ver Perfil</a>
      <br>
        <button type="submit" onclick="ocultarElemento()" >Enviar</button>

    </form>
</div>
<div id="tab2" class="tab">
    <i class="fas fa-link"></i>
    <h1 class="titulo"> Sube Tu Foto de Perfil</h1>
    <div class="sub">
        <input id="fileToUpload" type="file">
    </div>

    <button onclick="subirArchivo()">cargar</button>
    <div id="imageContainer" style="display: none;">
      <img id="uploadedImage" style="max-width: 100%; height: auto;">
      <button onclick="copiarURL()">Copiar URL de la Imagen</button>
  </div>
</div>
  </div>

</div>
<div class="chet" id="visible"> <span>Ya estas registrado</span>
    <script>
function openTab(tabName) {
    var i, tabContent, tabButtons;
    tabContent = document.getElementsByClassName("tab");
    for (i = 0; i < tabContent.length; i++) {
        tabContent[i].style.display = "none";
    }
    tabButtons = document.getElementsByClassName("tab-button");
    for (i = 0; i < tabButtons.length; i++) {
        tabButtons[i].classList.remove("active");
    }
    document.getElementById(tabName).style.display = "block";
    event.currentTarget.classList.add("active");
}
        </script> 
  <script>
  // Función para mostrar la vista previa (solo un ejemplo visual)
  function mostrarVistaPrevia() {
    var url = document.getElementById("url").value;
    var previsualizacion = document.getElementById("preview-image");
    var preview = document.getElementById("preview");
    var previewno = document.getElementById("preview-no");
    preview.style.display = "none"
    previewno.style.display = "block"
    previsualizacion.src = url; // Imagen de relleno
    previsualizacion.style.display = "block"
  }

  function NomostrarVistaPrevia() {
    var previsualizacion = document.getElementById("preview-image");
    var preview = document.getElementById("preview");
    var previewno = document.getElementById("preview-no");
    preview.style.display = "block"
    previewno.style.display = "none"
    previsualizacion.style.display = "none"
  }

    document.addEventListener("DOMContentLoaded", function () {
      const form = document.getElementById("data-form");

      form.addEventListener("submit", function (e) {
        e.preventDefault();

        const nombre = document.getElementById("nombre").value;
        const codigo = document.getElementById("codigo").value;
        const modelo = document.getElementById("modelo").value;
        const url = document.getElementById("url").value;

        const formData = {
          nombre: nombre,
          codigo: codigo,
          modelo: modelo,
          url: url,
        };

        fetch("https://script.google.com/macros/s/AKfycbx2c2L16hy5ahAxRdT5q3pzkx1JI-9DM7zW7E8rt5aEnNDDZyYobHBRuffnpOV9Y8xvUQ/exec", {
          method: "POST",
          body: JSON.stringify(formData),
        })
          .then(response => response.text())
          .then(data => {
            console.log(data);
            alert("De 10 minutos su cuenta estara activa");
          })
          .catch(error => {
            console.error("Error:", error);
            alert("Hubo un error en los datos");
          });
      });
    });
    function ocultarElemento() {
      const audioElement = document.getElementById("miMusica");
      audioElement.play();
      // Obtener la fecha actual
      const fechaActual = new Date();
      
      // Calcular la fecha de reaparición (1 día después)
      const fechaReaparicion = new Date();
      fechaReaparicion.setDate(fechaActual.getDate() + 1);
      
      // Convertir la fecha de reaparición a formato de cookie
      const fechaReaparicionUTC = fechaReaparicion.toUTCString();
      
      // Establecer una cookie con la fecha de reaparición
      document.cookie = `ocultarElemento=true; expires=${fechaReaparicionUTC}; path=/`;
      
      // Ocultar el elemento
      document.getElementById("elementoParaOcultar").style.display = "none";
      document.getElementById("visible").style.display = "block";
      // Deshabilitar el botón
      document.getElementById("botonOcultar").disabled = true;

  }

  // Verificar si la cookie existe al cargar la página
  window.onload = function () {
      if (document.cookie.includes("ocultarElemento=true")) {
          document.getElementById("elementoParaOcultar").style.display = "none";
          const audioElement = document.getElementById("miMusica");
          audioElement.play();
          document.getElementById("visible").style.display = "block";
          document.getElementById("botonOcultar").disabled = true;
          
      }
  };
  </script>
  <script>

    async function subirArchivo() {
      var inputFile = document.getElementById("fileToUpload");
      var imageContainer = document.getElementById("imageContainer");

      if (inputFile.files.length == 0) {
          alert("Por favor selecciona un archivo");
          return;
      } else {
          var file = inputFile.files[0];
          var storageRef = firebase.storage().ref("users/" + file.name);

          await storageRef.put(file);
          console.log("Carga completada...");

          var imagePath = "users/" + file.name;
          abrirArchivo(imagePath, imageContainer);
      }
  }

  async function abrirArchivo(path, container) {
      var storageRef = firebase.storage().ref(path);
      var url = await storageRef.getDownloadURL();
      var uploadedImage = document.getElementById("uploadedImage");

      uploadedImage.src = url;
      container.style.display = "block";
  }

  function copiarURL() {
      var url = document.getElementById("uploadedImage").src;
      var tempInput = document.createElement("input");
      document.body.appendChild(tempInput);
      tempInput.value = url;
      tempInput.select();
      document.execCommand("copy");
      document.body.removeChild(tempInput);
      alert("URL de la imagen copiada al portapapeles: " + url);
  }
    </script>
</body>
</html>